[
  {
    "name":"MannoMarker",
    "code":"javascript:\nvar authors = document.querySelectorAll(\".content[role='main'] a.author\"),\n    author = authors[0],\n    authorPointer = 0,\n    passes = [],\n    ib = document.querySelector(\".content[role='main']\").firstChild;\n\nfunction parseDuration(str) {\n  var dig = /[0-9]+/g,\n      units = /minute|hour|day|week|month|year/gi;\n  var time = 0,\n      unitMap = {\n        none: 0,\n        minute: 1,\n        hour: 60,\n        day: 1440,\n        week: 10080,\n        month: 43830,\n        year: 525960\n      };\n  while (true) {\n    var newTime = dig.exec(str);\n    if (!newTime) break;\n    var unit = units.exec(str) || [\"none\"];\n    time += 60 * unitMap[unit[0].toLowerCase()] * parseInt(newTime[0]);\n  }\n  return time;\n}\n\nfunction getAuthor() {\n  var xhr = new XMLHttpRequest();\n  xhr.onreadystatechange = function() {\n    if (this.readyState == 4 && this.status == 200) {\n      var data = JSON.parse(xhr.responseText).data;\n      var created = data.created;\n      if (created > minTime) {\n        getThing(author, highlight);\n        getThing(author, addTSBLink);\n        var tag = document.createElement(\"a\");\n        tag.innerHTML = \"(created \" + toTimeString(created) + \") \";\n        tag.href = \"https://layer7.solutions/blacklist/reports/#type=user&subject=\" + author.innerHTML;\n        tag.setAttribute(\"target\", \"_blank\");\n        tag.style.cssText = \"color:#920000; font-weight:bold; text-decoration:none\";\n        author.parentElement.insertBefore(tag, author.nextElementSibling);\n        var karma = document.createElement(\"span\");\n        karma.innerHTML = \"(\" + data.link_karma + \"|\" + data.comment_karma + \") \";\n        karma.setAttribute(\"title\", data.link_karma + \" link karma, \" + data.comment_karma + \" comment karma\");\n        karma.style.cssText = \"color:#000a92; font-weight:bold; cursor:help\";\n        author.parentElement.insertBefore(karma, author.nextElementSibling);\n        var foundDuplicate = false;\n        for (var i = 0; i < passes.length; i++) {\n          if (passes[i].username == author.innerHTML) {\n            foundDuplicate = true;\n            break;\n          }\n        }\n        if (!foundDuplicate) {\n          passes.push({\n            created: toTimeString(created),\n            createdEpoch: created,\n            createdStr: new Date(created * 1000).toString(),\n            username: author.innerHTML,\n            url: author.href,\n            holyShitThisIsSomeSpecificData: data\n          });\n        }\n      } else {\n        getThing(author, hide);\n      }\n      author = authors[++authorPointer];\n      prog.innerHTML = Math.floor(authorPointer / authors.length * 1000) / 10 + \"%\";\n      if (author) getAuthor();\n      else tally();\n    }\n  };\n  xhr.open(\"GET\", author + \"/about.json\", true);\n  xhr.send();\n}\n\nfunction getThing(elem, func) {\n  while (true) {\n    if (elem.classList.contains(\"thing\")) break;\n    else if (elem.tagName == \"BODY\") return;\n    elem = elem.parentElement;\n  }\n  func(elem);\n}\n\nfunction hide(elem) {\n  elem.style.display = \"none\";\n}\n\nfunction highlight(elem) {\n  elem.style.cssText = \"background:#ff8d8d !important; padding:5px !important; border:1px solid #920000 !important\";\n  ib.parentElement.insertBefore(elem, ib.nextElementSibling);\n  ib = elem;\n}\n\nfunction addTSBLink(elem) {\n  if (elem.classList.contains(\"link\")) {\n    var lnk = elem.querySelector(\".title a\").href;\n    if (/youtu.?be/gi.test(lnk)) {\n      var li = document.createElement(\"li\");\n      li.innerHTML = \"<a href='https://layer7.solutions/blacklist/reports/#type=channel&subject=\" + encodeURIComponent(lnk) + \"' target='_blank'>history</a>\";\n      elem.querySelector(\".flat-list.buttons\").appendChild(li);\n    }\n  }\n}\n\nfunction tally() {\n  console.log(passes);\n  document.body.removeChild(prog);\n  var uCount = passes.length;\n  setTimeout(function() {\n    alert(\"Found \" + uCount + \" user\" + (uCount == 1 ? '' : 's') + \" younger than \" + durStr + \".\nUser data is logged in console.\");\n  }, 10);\n}\n\nfunction toTimeString(epoch) {\n  var time = Math.floor((new Date().getUTCTime() / 1000) - epoch) / 60;\n  var units = [525960, \"year\", 43830, \"month\", 1440, \"day\", 60, \"hour\", 1, \"minute\"],\n      out = [];\n  for (var i = 0; i < units.length; i += 2) {\n    var newTime = Math.floor(time / units[i]);\n    if (newTime) out.push(newTime + \" \" + units[i + 1] + (newTime == 1 ? '' : 's'));\n    time = time % units[i]\n  }\n  out = out.splice(0, 3);\n  return out.join(\", \") + \" ago\";\n}\n\nfunction quit() {\n  authorPointer = 10000000;\n}\n\nDate.prototype.getUTCTime = function() {\n  return this.getTime() + this.getTimezoneOffset() * 60000;\n};\n\nvar durStr = prompt(\"Enter maximum age.\nPress the white box in the upper left corner to quit.\", \"1 day\");\nif (durStr) {\n  var minTime = Math.floor(new Date().getUTCTime() / 1000) - parseDuration(durStr);\n  if (confirm(\"Searching for users made later than \" + toTimeString(minTime * 1000) + \".\nProceed?\")) {\n    var prog = document.createElement(\"div\");\n    prog.style.cssText = \"position:fixed; top:0; left:0; font-family:Arial,sans-serif; background:white; font-size:20px; padding:5px 10px; color:#777; border:1px solid #ccc; z-index:1000000; cursor:pointer\";\n    prog.onclick = quit;\n    prog.innerHTML = \"0%\";\n    document.body.appendChild(prog);\n    getAuthor();\n  }\n}",
    "description":"Input a duration, and the script will throw all comments or posts from accounts made within that duration to the top of the page and hide the rest for easy detection of new accounts, spammers, and account farmers.",
    "version":"2.5",
    "notes":"MannoMarker supports duration input in minutes/hours/days/months/years. Example: \"5 years 23 days\" or \"34 hours 2 days\". The order doesn't matter and you will be given an interpreted duration before the analysis begins.",
    "changelog":"This is the first public version of this bookmarklet.",
    "published":"1500000000",
    "domain":"reddit.com"
  },
  {
    "name":"Lookup",
    "code":"javascript: (function(){\n  var uData = [],\n      counter = 0,\n      uniques = [],\n      users = document.querySelectorAll(\".commentarea .sitetable .author:not(.counted)\");\n\n  var cf = prompt(\"Found \" + users.length + \" users.\\nEnter subreddit. Leave blank for full list.\\nTo check for multiple subs, separate by commas.\\nCheck console for data dump.\");\n  if (cf == null) return;\n  cf = cf.replace(/ /, \"\");\n  var regex = new RegExp(\"^(\" + cf.replace(/,/g, \"|\") + \")$\", \"gim\"),\n      prog = document.getElementById(\"progresscounter\"),\n      slider;\n  if (prog) prog.parentElement.removeChild(prog);\n  prog = document.createElement(\"div\");\n  prog.id = \"progresscounter\";\n  prog.style.cssText = \"position:fixed; width:100%; height:2em; top:0; left:0; line-height:2em; text-align:center; color:black; background:white; border-bottom:1px solid #ccc; z-index:20000000\";\n  slider = document.createElement(\"div\");\n  prog.appendChild(slider);\n  var data = document.createElement(\"div\");\n  data.style.cssText = \"position:fixed; top:0; width:100%\";\n  prog.appendChild(data);\n  document.body.appendChild(prog);\n  prog = data;\n  prog.style.display = \"block\";\n  slider.style.cssText = \"position:absolute; height:100%; width:0; background:#ccf\";\n\n  function getUserData() {\n    if (counter == users.length) {\n      if (cf) tally();\n      console.log(uData);\n      prog.parentElement.style.display = \"none\";\n      return;\n    } else {\n      var perc = Math.ceil((counter + 1) / users.length * 100);\n      slider.style.width = perc + \"%\";\n      prog.innerHTML = \"Collecting data from users: \" + (counter + 1) + \"/\" + users.length + \" (\" + perc + \"%)\";\n    }\n    var xhttp = new XMLHttpRequest(),\n        parent = users[counter];\n    xhttp.onreadystatechange = function() {\n      if (this.readyState == 4 && this.status == 200) {\n        var uD = JSON.parse(xhttp.responseText).data.children,\n            out = [];\n        for (var i = 0; i < uD.length; i++) {\n          out.push(uD[i].data.subreddit);\n        }\n        uData.push(out, users[counter - 1]);\n        getUserData();\n      } else if (this.readyState == 4 && this.status == 404) {\n        getUserData();\n      }\n    };\n    xhttp.open(\"GET\", \"https://www.reddit.com/user/\" + users[counter].innerHTML + \"/.json\", true);\n    xhttp.send();\n    users[counter].classList.add(\"counted\");\n    counter++;\n  }\n\n  function tally() {\n    var matches = 0,\n        totals = 0;\n    for (var i = 0; i < uData.length; i += 2) {\n      var elem = uData[i + 1].parentElement.parentElement.parentElement;\n      if (!elem) continue;\n      var subs = [];\n      for (var n = 0; n < uData[i].length; n++) {\n        totals++;\n        if (regex.test(uData[i][n])) {\n          matches++;\n          appendElem(uData[i][n], subs);\n        }\n      }\n      if (subs.length > 0) {\n        elem.getElementsByClassName(\"author\")[0].innerHTML += \" <i style='color:white'>(\" + subs.join(\",\") + \")</i>\";\n        appendElem(uData[i + 1].innerHTML, uniques);\n        elem.style.cssText = getDepth(elem) % 2 == 0 ? \"background:#fc0 !important\" : \"background:orange !important\";\n      }\n    }\n    cf = ((/,/).test(cf)) ? \"[\" + cf + \"]\" : cf;\n    var outStr = \"Matched \" + cf + \" in \" + matches + \"/\" + totals + \" (\" + Math.round(matches / totals * 10000) / 100 + \"%) comments.\\n\" + uniques.length + \" (\" + Math.round(uniques.length / uData.length * 20000) / 100 + \"%) unique users have recent history in \" + cf + \".\\n\";\n    alert(outStr);\n    console.log(outStr);\n  }\n\n  function appendElem(elem, arr) {\n    for (var i in arr) {\n      if (arr[i] == elem) return;\n    }\n    arr.push(elem);\n  }\n\n  function getDepth(elem) {\n    var len = 0;\n    while (!elem.classList.contains(\"nestedlisting\")) {\n      len++;\n      elem = elem.parentElement;\n    }\n    return len;\n  }\n\n  getUserData();\n})();",
    "description":"Input one or many subreddit names and the script will find all users on the page with recent history in any of the subreddits.",
    "version":"3.0",
    "notes":"Separate subreddit names by commas to browse many subs. The names are not case sensitive.",
    "changelog":"This is the first public version of this bookmarklet.",
    "published":"1500000000",
    "domain":"reddit.com"
  },
  {
    "name":"Anon",
    "code":"javascript: (function() {\n  var usernames = document.querySelectorAll(\".content[role=main] .md a[href*='/u/'],.content[role=main] .md a[href*='/user/'], .md a[href*='/u/'], .sitetable .author[href*='/user/'], a[class*='_author'], .ModAction__author\"),\n      ids = [],\n      names = [],\n      op = \"\",\n      opDOM = document.querySelector(\".single-page .thing.link\");\n  if (opDOM != null) {\n    op = opDOM.getAttribute(\"data-author\");\n  }\n  var style = document.createElement(\"style\");\n  style.innerHTML = \".hiddenuser{display: inline-block; padding: 0 5px !important; font-weight: bold; font-size:12px !important; border-radius:0 !important; height: 17px; line-height: 17px; box-sizing:content-box !important;} .tb-bracket-button, .flair{display:none !important;} #user_popup {display: block; position: fixed; width: 200px; background-color: #f5f5f5; padding: 10px; text-align: center; border: 1px solid #ddd; font-size: 13px; z-index: 100; left: 10px; bottom: -100px; box-shadow: 2px 2px 10px rgba(0,0,0,0.1); line-height: 25px; animation: move 10s forwards 1;} #user_popup .highlighted {padding: 2px 6px; color: white; background-color: #ccc;} @keyframes move{0%{bottom: -100px;} 5%{bottom: 10px;} 95%{bottom: 10px;} 100%{bottom: -100px;}}\";\n  document.body.appendChild(style);\n  for (var i = 0; i < usernames.length; i++) {\n    var href = usernames[i].className == \"ModAction__author\" ? usernames[i].textContent : usernames[i].href,\n        arr = href.includes(\"/u/\") ? href.split(\"/u/\") : href.split(\"/user/\"),\n        name = arr[arr.length - 1].replace(/\\//g, '');\n    ids.push(getId(name));\n    usernames[i].classList.add(\"hiddenuser\");\n    usernames[i].innerHTML = name == op ? \"OP\" : \"User \" + (ids[i] + (op != '' ? 0 : 1));\n  }\n  for (var i = 0; i < usernames.length; i++) {\n    setColor(usernames[i], ids[i]);\n  }\n  var popup = document.createElement(\"div\");\n  popup.id = \"user_popup\";\n  popup.innerHTML = \"<span class='highlighted'>\" + usernames.length + \"</span> overlays added and<br><span class='highlighted'>\" + names.length + \"</span> users hidden\";\n  document.body.appendChild(popup);\n\n  function getId(name) {\n    for (var i = 0; i < names.length; i++) {\n      if (name == names[i]) {\n        return i\n      }\n    }\n    names.push(name);\n    return names.length - 1;\n  }\n\n  function setColor(dom, id) {\n    var colors = [\n          [255, 0, 0],\n          [0, 255, 0],\n          [0, 0, 255]\n        ],\n        quot = id / names.length,\n        offs = Math.floor(quot / 0.5);\n    quot = (quot % 0.5) * 2;\n    dom.style.cssText = \"background-color: rgb(\" + Math.floor(colors[offs][0] + (colors[offs + 1][0] - colors[offs][0]) * quot) + \",\" + Math.floor(colors[offs][1] + (colors[offs + 1][1] - colors[offs][1]) * quot) + \",\" + Math.floor(colors[offs][2] + (colors[offs + 1][2] - colors[offs][2]) * quot) + \") !important; color: white !important\";\n  }\n})();",
    "description":"Hides all usernames on the page and numbers and color codes them for clarity.",
    "version":"2.0",
    "notes":"Should also work in MannoMail.",
    "changelog":"This is the first public version of this bookmarklet.",
    "published":"1500000000",
    "domain":"reddit.com"
  },
  {
    "name":"Nuke",
    "code":"javascript: (function() {\n  var prevElem = document.body,\n      hover = true;\n  if (!document.body.classList.contains(\"event_added\")) {\n    document.body.addEventListener(\"mousemove\", function(event) {\n      if (hover) {\n        var element = findThing(event.target);\n        prevElem.style = \"\";\n        element.style = \"background-color: rgba(255,0,0,0.5)!important\";\n        prevElem = element\n      }\n    });\n    document.body.addEventListener(\"click\", function() {\n      if (hover) {\n        hover = false;\n        var action = confirm(\"Do you want to remove this comment and its children?\\n\\nNote: the script sends an alert when it's finished. Let it work.\\n\");\n        if (action) {\n          var removeBtns = prevElem.getElementsByClassName(\"remove-button\"),\n              count = 1,\n              thread = setInterval(rem, 500);\n\n          function rem() {\n            removeBtns[count].getElementsByClassName(\"yes\")[0].click();\n            count += 2;\n            if (count >= removeBtns.length) {\n              clearInterval(thread);\n              prevElem.style = \"\";\n              setTimeout(function() {\n                alert(\"Removed \" + removeBtns.length / 2 + \" comments\");\n              }, 500);\n            }\n          }\n        } else {\n          prevElem.style = \"\";\n        }\n      }\n    });\n  }\n  document.body.classList.add(\"event_added\");\n\n  function findThing(elem) {\n    var findElem = elem;\n    try {\n      for (var i = 0; i < 10; i++) {\n        if (findElem.classList.contains(\"thing\")) {\n          return findElem;\n        }\n        findElem = findElem.parentElement;\n      }\n    } catch (e) {}\n    return elem;\n  }\n})()",
    "description":"Simply removes a comment and all its visible children.",
    "version":"1.0",
    "notes":"Toolbox has this feature implemented.",
    "changelog":"This is the first public version of this bookmarklet.",
    "published":"1500000000",
    "domain":"reddit.com"
  }
]
